<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Menu</title>
    <link rel="stylesheet" href="maincss/kiosk.css">
</head>
<body>
    <div class="container">
        <nav class="sidebar">
            <div class="logo" role="img" aria-label="Restaurant logo"></div>
            <button class="category-btn" data-category-id="all">All</button>
            <% category.forEach(ca => { %>
            <button class="category-btn" data-category-id="<%= ca.category_id %>"><%= ca.category_name %></button>
            <% }) %>
        </nav>
        <main class="main-content">
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Search for items..." aria-label="Search for menu items">
                <span class="search-icon" aria-hidden="true">üîç</span>
            </div>
            <div class="menu-grid-container">
                <div class="menu-grid">
                    <% product.forEach(p => { %>
                    <div class="menu-item"data-name="<%= p.name %>" 
                        data-price="<%= p.price %>" 
                        data-image="/uploads/<%= p.product_image %>">
                        <img src="/uploads/<%= p.product_image %>" alt="Carbonara">
                        <h3><%= p.name %></h3>
                    </div>
                    <% }) %>
                </div>
            </div>
            <div id="product-modal" class="modal hidden">
                <div class="modal-content">
                    <h2 id="modal-title">Product Name</h2>
                    <img id="modal-image" src="" alt="Product Image">
                    <div class="quantity-control">
                        <button id="decrease-qty" class="qty-btn">-</button>
                        <span id="quantity">1</span>
                        <button id="increase-qty" class="qty-btn">+</button>
                    </div>
                    <p id="modal-price">‚Ç± 0.00</p>
                    <button id="add-to-order" class="modal-btn">Add to Order</button>
                    <button id="cancel-modal" class="modal-btn cancel-btn">Cancel</button>
                </div>
            </div>
            <footer class="footer">
                <div class="total-cost">Total: ‚Ç± 0.00</div>
                <div class="order-summary">
                    <!-- Order summary will be populated dynamically -->
                </div>
                <button class="review-order-btn">Review Order</button>
            </footer>
        </main>
    </div>
</body>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const categoryButtons = document.querySelectorAll('.category-btn');
        const menuGrid = document.querySelector('.menu-grid');
        const modal = document.getElementById('product-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalImage = document.getElementById('modal-image');
        const modalPrice = document.getElementById('modal-price');
        const quantityDisplay = document.getElementById('quantity');
        const addToOrderBtn = document.getElementById('add-to-order');
        const cancelModalBtn = document.getElementById('cancel-modal');
        const decreaseQtyBtn = document.getElementById('decrease-qty');
        const increaseQtyBtn = document.getElementById('increase-qty');

        let currentQuantity = 1;

        // Attach click event to category buttons
        categoryButtons.forEach(button => {
            button.addEventListener('click', () => {
                const categoryId = button.getAttribute('data-category-id');

                fetch(`/kiosk/products/${categoryId}`)
                    .then(response => response.json())
                    .then(products => {
                        // Clear the menu grid
                        menuGrid.innerHTML = '';

                        // Populate the menu grid with the new products
                        products.forEach(product => {
                            const menuItem = `
                                <div class="menu-item" 
                                    data-name="${product.name}" 
                                    data-price="${product.price}" 
                                    data-image="/uploads/${product.product_image}">
                                    <img src="/uploads/${product.product_image}" alt="${product.name}">
                                    <h3>${product.name}</h3>
                                </div>
                            `;
                            menuGrid.innerHTML += menuItem;
                        });

                        
                        
                        attachMenuItemEvents();
                    })
                    .catch(error => console.error('Error fetching products:', error));
            });
        });

        function attachMenuItemEvents() {
            const menuItems = document.querySelectorAll('.menu-item');

            menuItems.forEach(item => {
                item.addEventListener('click', () => {
                    const name = item.getAttribute('data-name');
                    const price = item.getAttribute('data-price');
                    const image = item.getAttribute('data-image');

                    modalTitle.textContent = name;
                    modalImage.src = image;
                    modalPrice.textContent = `‚Ç± ${price}`;
                    currentQuantity = 1;
                    quantityDisplay.textContent = currentQuantity;

                    modal.classList.remove('hidden');
                });
            });
        }

        increaseQtyBtn.addEventListener('click', () => {
            currentQuantity++;
            quantityDisplay.textContent = currentQuantity;
        });

        decreaseQtyBtn.addEventListener('click', () => {
            if (currentQuantity > 1) {
                currentQuantity--;
                quantityDisplay.textContent = currentQuantity;
            }
        });

        addToOrderBtn.addEventListener('click', () => {
            console.log(`Added to order: ${modalTitle.textContent}, Quantity: ${currentQuantity}, Price: ${modalPrice.textContent}`);
            modal.classList.add('hidden');
        });

        cancelModalBtn.addEventListener('click', () => {
            modal.classList.add('hidden');
        });

        
        attachMenuItemEvents();
    });
</script>




</html>