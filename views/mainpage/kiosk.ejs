<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2n1 Self-Ordering Kiosk</title>
  <link rel="stylesheet" href="maincss/kiosk.css">
</head>
<body>
  <header class="header">
    <h1>2n1</h1>
  </header>
  <div class="main-container">
    <!-- Categories Sidebar -->
    <aside class="categories">
      <h2>Categories</h2>
      <ul id="category-list">
        <li onclick="filterDishes('all')">
          <img src="milktea.png" alt="Logo" class="category-logo"> All
        </li>        
        <% category.forEach(c => { %>
        <li onclick="filterDishes(<%= c.category_id %>)">
          <img src="milktea.png" alt="<%= c.category_name %> Logo" class="category-logo"> <%= c.category_name %>
        </li>
        <% }) %>
      </ul>
    </aside>

    <!-- Dishes Section -->
    <section class="dishes" id="dish-list">
      
      <% product.forEach(p => { %>
      <div class="dish-item" onclick="addToOrder({ name: 'Spring Rolls', price: 5.99 })">
        <img src="/uploads/<%= p.product_image %>" alt="Spring Rolls" class="dish-image">
        <div class="dish-info">
          <strong><%= p.name %></strong>
        </div>
      </div>
      <% }) %>
    </section>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-left">
      <h3>Total: <span id="total-price">$0.00</span></h3>
    </div>
    <div class="footer-center">
      <ul id="order-list" class="scrollable"></ul>
    </div>
    <div class="footer-right">
      <button id="review-order" onclick="reviewOrder()">Review Order</button>
    </div>
  </footer>

  <script>
    async function filterDishes(category_id) {
    try {
        const response = await fetch(`/kiosk/products/${category_id}`);
        const products = await response.json();

        const dishList = document.getElementById('dish-list');
        dishList.innerHTML = ''; // Clear the existing product list

        products.forEach(product => {
            const dishItem = document.createElement('div');
            dishItem.className = 'dish-item';
            dishItem.onclick = () => addToOrder({ name: product.name, price: product.price });

            dishItem.innerHTML = `
                <img src="/uploads/${product.product_image}" alt="${product.name}" class="dish-image">
                <div class="dish-info">
                    <strong>${product.name}</strong>
                </div>
            `;
            dishList.appendChild(dishItem);
        });
    } catch (error) {
        console.error('Error fetching products by category:', error);
    }
}

  </script>
</body>
</html>
